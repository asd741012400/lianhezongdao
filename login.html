<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta content="e智教管理平台" name="Keywords">
    <meta name="description" content="e智教管理平台" />
    <link href="images/iconfont-yunpingtai-2.png" rel="shortcut icon">
    <title>e智教管理平台</title>
    <style>
        body {
            font-family: "Microsoft YaHei", Arial, sans-serif;
            font-size: 14px;
            background: #ffffff;
            margin: 0;
            padding: 0;
            overflow: hidden;
        }
        .header {
            width: 100%;
            height: 80px;
            background: #ffffff;
            top: 0px;
            left: 0px;
            z-index: 999;
            position: fixed;
            z-index: 3000;
        }
        .top {
            width: 1200px;
            height: 80px;
            line-height: 80px;
            margin: 0 auto;
            font-size: 12px;
            color: #333;
        }
        .logo {
            width: 30%;
            height: 60px;
            float: left;
            margin: 15px 5% 10px 2%;
        }
        .navbox {
            width: 50%;
            height: 80px;
            float: left;
            color: #666;
        }
        .navbox a {
            width: 30%;
            _width: 80px;
            height: 80px;
            line-height: 80px;
            display: block;
            float: right;
            font-size: 16px;
            text-align: center;
            color: #666;
            text-decoration: none;
        }
        .navbox a:hover {
            color: #333;
        }
        *:focus {
            outline: none;
        }
        .loginBox {
            background: #f8f8f8 url(images/bg.jpg) no-repeat 30% 45%;
            height: 50%;
            padding-top: 11%;
            padding-bottom: 10%;
            padding-left: 5%;
            color: #ffffff;
            overflow: hidden;
        }
        .loginBox_title {
            text-align: center;
            font-size: 30px;
            margin-bottom: 10px;
        }
        .loginbox_bg {
            width: 1200px;
            margin: 0 auto;
        }
        .loginBox_left {
            width: 465px;
            float: left;
            padding-left: 50px;
        }
        .loginBox_content {
            width: 380px;
            color: #888;
            padding: 5px;
            animation: loginBox_content 1s 1;
            float: left;
        }
        .pic_loin {
            width: 150px;
            margin: 40px auto;
            animation: loginBox_content 1s 1;
        }
        .loginBox_content_t {
            background: #fff;
            min-height: 30px;
        }
        .tex {
            padding: 15px 50px 10px 60px;
            border-bottom: 1px solid #eee;
            color: #3CF;
            font-size: 18px;
        }
        .tex span {
            font-size: 12px;
            margin-left: 5px;
        }
        .loginBox_content_t1 {
            text-align: right;
            background-color: #ffe4d8;
            margin-top: 20px;
            margin-left: 35px;
            width: 300px;
            padding: 0px 5px;
            line-height: 30px;
            float: left;
            display: none;
        }
        .loginBox_content_c {
            padding: 10px 0px 20px 0px;
            border-radius: 0px 0px 5px 5px;
            background: #ffffff;
        }
        .loginBox_content_c_div {
            margin: 10px 23px;
            text-align: center;
        }
        .input {
            width: 220px;
            border: 1px solid #eeeeee;
            background: #f3f3f3;
            line-height: 35px;
            height: 35px;
            padding: 0px 5px;
            padding-left: 5px;
            margin-left: 35px;
            font-size: 14px;
        }
        .input:hover {
            border: 1px solid #c4d5e9;
            border-spacing: inherit;
        }
        input:-webkit-autofill {
            -webkit-box-shadow: 0 0 0px 1000px white inset;
        }
        .inputSub {
            width: 34%;
            outline: none;
            background: #4bacea;
            border: none;
            border-bottom: 1px solid #4098d1;
            border-radius: 3px;
            cursor: pointer;
            line-height: 30px;
            font-size: 14px;
            color: #fff;
            font-family: "Microsoft YaHei";
            margin-left: 30px;
            margin-right: 4px;
        }
        .inputSub:hover {
            background: #4da2dc;
            border-bottom: 1px solid #3a8bbf;
        }
        .inputSub1 {
            width: 34%;
            outline: none;
            background: #f8f8f8;
            border: 1px solid #dadada;
            border-bottom: 1px solid #dadada;
            border-radius: 3px;
            cursor: pointer;
            line-height: 30px;
            font-size: 14px;
            color: #7d99af;
            font-family: "Microsoft YaHei";
        }
        .inputSub1:hover {
            background: #eeeeee;
        }
        .loginBox_bottom {
            width: 1200px;
            margin: 0 auto;
            text-align: center;
            color: #999;
            margin-top: 20px;
        }
        .loginBox_content_b {
            width: 98%;
            margin: 0px auto;
            height: 8px;
            border-radius: 0px 0px 5px 5px;
            background: #f4f4f4;
        }
        .box_bg {
            margin-top: -2px;
        }
        .footBtns {
            text-align: center;
            padding: 50px 0px;
        }
        .footBtns a {
            border-radius: 5px;
            padding: 10px 50px;
            margin: 20px;
            border: 1px solid #fff;
            color: #fff;
            text-decoration: none;
        }
        .footBtns a:hover {
            background: #000;
        }
        #ajaxText {
            color: #ff6776;
            float: left;
        }
        #closeBtn {
            cursor: pointer;
            color: #fff;
            background-color: #fa6f1b;
            padding: 0px 5px;
            border-radius: 10px;
            font-family: Arial;
        }
        .inputImg {
            position: absolute;
            margin-top: 10px;
            margin-left: 7px;
        }
    </style>
</head>

<body>
    <!--公用头部-->
    <div class="header">
        <div class="top">
            <div class="logo">
                <img src="images/logo_login.png" width="350" />
            </div>
            <div class="navbox">
                <a href="app.html" id="qrcodeShow" target="">APP下载<img src="images/app.png" style="border:none; outline:none; vertical-align:middle; margin-left:3px; margin-top:-5px;"></a>
                <img style="position: absolute; top: 70px;left: 50%;margin-left: 260px; display: none;box-shadow: 0 2px 4px rgba(0,0,0,0.2); border: 1px solid #e4e4e4;width: 150px;background: #fff;padding: 5px;" id="qrcode" src="images/qrcode.png" />
            </div>
        </div>
    </div>
    <form id="form1">
        <div class="loginBox">
            <div class="loginbox_bg">
                <div class="loginBox_left">
                    <img src="images/tex.png" style=" padding-top:20px;">
                </div>
                <div class="loginBox_content">
                    <div class="loginBox_content_t">
                        <div class="tex">用户登录<span>LOGIN</span>
                        </div>
                        <div class="loginBox_content_t1 gery"><span id="ajaxText">请输入账号密码...</span><span id="closeBtn">x</span>
                        </div>
                        <div style="clear: both;"></div>
                    </div>
                    <div class="loginBox_content_c">
                        <div class="loginBox_content_c_div">
                            <img class="inputImg" src="images/icon_login_user.png" />
                            <input class="input" id="account" placeholder="请输入用户名" type="text" />
                        </div>
                        <div class="loginBox_content_c_div">
                            <img class="inputImg" src="images/icon_login_pwd.png" />
                            <input class="input" id="password" placeholder="请输入密码" type="password" />
                        </div>
                        <div style="clear: both;"></div>
                        <div class="loginBox_content_c_div">
                            <input class="inputSub" id="login" type="submit" value="登录" />
                            <input class="inputSub1" id="login1" type="reset" value="重置" />
                        </div>
                    </div>
                    <div class="box_bg">
                        <img src="images/box_bg.png">
                    </div>
                </div>
            </div>
        </div>
        <div class="loginBox_bottom">2016 © 重庆联和纵道科技股份有限公司版权所有.</div>
    </form>
    <script type="text/javascript" src="js/jquery-1.8.3.min.js?id=1545966011305__"></script>
    <script type="text/javascript" src="js/MD5.js?id=1545966011305__"></script>
    <script type="text/javascript" src="js/json2.js?id=1545966011305__"></script>
    <script type="text/javascript" src="js/tool.js?id=1545966011305__"></script>
    <script type="text/javascript" src="js/config.js?id=1545966011305__"></script>
    <script type="text/javascript" src="js/common.js?id=1545966011305__"></script>
    <script type="text/javascript">
        $("#qrcodeShow").mouseover(function () {
            $("#qrcode").show();
        })
         $("#qrcodeShow").mouseout(function () {
            $("#qrcode").hide();
        })
         $("#closeBtn").click(function () {
            $(this).parent().hide();
        })
        if (Y.User.GetLogin("account")) {
            $("#account").val(Y.User.GetLogin("account"));
        }
        $("#form1").submit(function (e) {
            var account = $("#account").val();
            var password = $("#password").val();
            if (!account || !password) {
                $("#ajaxText").parent().show();
                $("#ajaxText").html("用户名和密码不能为空");
                return false;
            }
            if (e && e.preventDefault) {
                e.preventDefault();
            } else {
                window.event.returnValue = false;
                return false;
            }
            $("#ajaxText").parent().show();
            $("#ajaxText").html("正在登陆，请稍后......");
            var ajax = new Y.Ajax(ucIP + "/api/uc/v0.1/login", function (res) {

                $("#ajaxText").parent().show();
                if (res && !res.errorMsg) {
                    if (Y.User.GetLogin("password") != password || Y.User.GetLogin("account") != account) {
                        Y.User.SetLogin(account, '--');
                    }
                    Y.User.Set(res);
                    var canLogin = true;
                    var redirect_uri = '';
                    if(res.accountType == 1) {
                        if(res.schoolInfo && res.schoolInfo.length == 1 && res.schoolInfo[0].szhxy){
                            redirect_uri = res.schoolInfo[0].szhxy + '?accessToken=' + res.accessToken;
                        }else{
                            canLogin = false;
                        }
                    }
                    if(canLogin){
                        location = redirect_uri ? redirect_uri : "index.html";
                    }else{
                        $("#ajaxText").html('抱歉，您无权限登录本系统！');
                    }
                } else {
                    var msg = "登录失败";
                    if (res && res.errorMsg) msg += "，" + res.errorMsg;
                    $("#ajaxText").html(msg);
                }
            }, {
                meth: "POST",
                data: {
                    account: account,
                    password: MD5(password)
                },
                dataJson: true,
                noLoginAction: true,
                header: [{
                    key: "x-tags",
                    vaule: 'eschool-mgn'
                }],
                loading:{
                    open:function(){Y.creatCover({id:"loginCover",obj:window,zIndex:Y.zIndex(4),opacity:0,background:"#000000",position:"fixed"})},
                    close:function(){$('#loginCover').remove();}
                }
            })
            ajax.action();
        })
    </script>
</body>

</html>